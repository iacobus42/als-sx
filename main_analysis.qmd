---
title: Main Analysis
author: Jacob Simmering
format: 
  html:
    embed-resources: true
---

```{r pkg-load}
library(tidyverse)
library(survival)
library(tableone)
```

# Data Loading and Processing
```{r}
model_data <- read_rds("/Shared/lss_jsimmeri/als/model_data.rds")
```

```{r}
model_data <- model_data |>
  mutate(
    age = first_year - dobyr,
    female = sex == 1,
    stratum = as.numeric(as.factor(glue::glue("{first_year}-{last_year}-{dobyr}-{sex}")))
  ) |>
  mutate(any_sx = motor | bulbar,
         n_groups = motor + bulbar,
         n_bulbar = speech + swallowing,
         n_motor = strength + gait + involuntary_movement + pain + other + falls,
         n_total = speech + swallowing + strength + gait + involuntary_movement + pain + other + falls)
```

# Data Summary
First, the data summary by ALS status:

```{r}
all_vars <- c(
  "age", "female", 
  "first_year", "last_year",
  "rate_outpatient_visits", "intensity_outpatient_visits_dx",
  "rate_inpatient_stays", "intensity_inpatient_stays_los",
  "elix_CHF", "elix_Valvular", "elix_PHTN", "elix_PVD", "elix_HTN",
  "elix_HTNcx", "elix_Paralysis", "elix_NeuroOther", "elix_Pulmonary", "elix_DM",
  "elix_DMcx", "elix_Hypothyroid", "elix_Renal", "elix_Liver", "elix_PUD", 
  "elix_HIV", "elix_Lymphoma", "elix_Mets", "elix_Tumor", "elix_Rheumatic", 
  "elix_Coagulopathy", "elix_Obesity", "elix_WeightLoss", "elix_FluidsLytes", "elix_BloodLoss", 
  "elix_Anemia", "elix_Alcohol", "elix_Drugs", "elix_Psychoses", "elix_Depression", 
  "lives_in_msa",
  "any_sx", "motor", "bulbar",
  "n_groups", "n_bulbar", "n_motor", "n_total",
  "speech", "swallowing", 
  "strength", "gait", "involuntary_movement", "pain", "other", "falls")
factor_vars <- c("n_groups", "n_bulbar", "n_motor", "n_total")
nonnormal_vars <- c("age", "first_year", "last_year", "rate_outpatient_visits", 
  "intensity_outpatient_visits_dx", "rate_inpatient_stays", 
  "intensity_inpatient_stays_los")

CreateTableOne(
  data = model_data,
  vars = all_vars,
  factorVars = factor_vars,
  strata = c("als")
) |>
  print(nonnormal = nonnormal_vars, smd = TRUE)
```

And then by ALS and whether they live in an MSA:

```{r}
CreateTableOne(
  data = model_data,
  vars = all_vars,
  factorVars = factor_vars,
  strata = c("als", "lives_in_msa")
) |>
  print(nonnormal = nonnormal_vars, smd = TRUE)
```

# Define Models
I want to fit XXXX models: 

First, does having any of these codes increase the odds of getting an ALS 
diagnosis?

```{r}
any_fml_unadj <- als ~ any_sx * lives_in_msa + strata(stratum)

any_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   any_sx * lives_in_msa + strata(stratum)
```

Second, what is the independent effect of bulbar symptoms?

```{r}
any_bulbar_unadj <- als ~ bulbar * lives_in_msa + strata(stratum)

any_bulbar_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   bulbar * lives_in_msa + strata(stratum)
```

Third, what is the independent effect of motor symptoms?

```{r}
any_motor_unadj <- als ~ motor * lives_in_msa + strata(stratum)

any_motor_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   motor * lives_in_msa + strata(stratum)
```

Fourth, what is the effect of symptoms from 0, 1, or 2 affects systems?

```{r}
number_origin_unadj <- als ~ as.factor(I(bulbar + motor)) * lives_in_msa + strata(stratum)

number_origin_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   as.factor(I(bulbar + motor)) * lives_in_msa + strata(stratum)
```

Fifth, what is the effect of the symptom sub-class? This is actually many 
models...

```{r}
speech_fml_unadj <- als ~ speech * lives_in_msa + strata(stratum)

speech_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   speech * lives_in_msa + strata(stratum)

swallowing_fml_unadj <- als ~ swallowing * lives_in_msa + strata(stratum)

swallowing_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   swallowing * lives_in_msa + strata(stratum)

strength_fml_unadj <- als ~ strength * lives_in_msa + strata(stratum)

strength_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   strength * lives_in_msa + strata(stratum)

gait_fml_unadj <- als ~ gait * lives_in_msa + strata(stratum)

gait_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   gait * lives_in_msa + strata(stratum)

involuntary_movement_fml_unadj <- als ~ involuntary_movement * lives_in_msa + strata(stratum)

involuntary_movement_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   involuntary_movement * lives_in_msa + strata(stratum)

pain_fml_unadj <- als ~ pain * lives_in_msa + strata(stratum)

pain_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   pain * lives_in_msa + strata(stratum)

other_fml_unadj <- als ~ other * lives_in_msa + strata(stratum)

other_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   other * lives_in_msa + strata(stratum)

falls_fml_unadj <- als ~ falls * lives_in_msa + strata(stratum)

falls_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   falls * lives_in_msa + strata(stratum)
```

Sixth, does the risk increase with each additional symptom?

```{r}
number_fml_unadj <- als ~ as.factor(n_total) * lives_in_msa + strata(stratum)

number_fml_fulladj <- als ~ rate_outpatient_visits + intensity_outpatient_visits_dx + 
                   rate_inpatient_stays + intensity_inpatient_stays_los +
                   elix_CHF + elix_Valvular + elix_PHTN + elix_PVD + elix_HTN +
                   elix_HTNcx + elix_Paralysis + elix_NeuroOther + elix_Pulmonary + elix_DM +
                   elix_DMcx + elix_Hypothyroid + elix_Renal + elix_Liver + elix_PUD + 
                   elix_HIV + elix_Lymphoma + elix_Mets + elix_Tumor + elix_Rheumatic + 
                   elix_Coagulopathy + elix_Obesity + elix_WeightLoss + elix_FluidsLytes + elix_BloodLoss + 
                   elix_Anemia + elix_Alcohol + elix_Drugs + elix_Psychoses + elix_Depression + 
                   as.factor(n_total) * lives_in_msa + strata(stratum)
```

Quick note: all of these models omit year, age, and sex. This is because the
data are matched on age, sex, and enrollment start/end dates. Including the 
strata accounts for these factors while also properly clustering the errors.

# Estimation
## Does Having Any Code Increase the Risk?
Without adjustment:

```{r}
clogit(
  any_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

The odds are increased following one or more symptom (OR = 7.44), for those 
living in MSAs (OR = 1.43), but there is a multiplicative decrease in odds for
ALS for those with symptoms living in an MSA (OR = 0.84). The odds are still
increased (OR = $0.84 * 7.44 = 6.25$) but less than for those who do not live
in MSAs.

After adjustment, the story stays the same:

```{r}
clogit(
  any_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

## Are There Differences Between Bulbar and Motor Symptoms?
First, only bulbar, without:

```{r}
clogit(
  any_bulbar_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

and with adjustment:

```{r}
clogit(
  any_bulbar_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

And then only motor without

```{r}
clogit(
  any_motor_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

and with adjustment:

```{r}
clogit(
  any_motor_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

## Does the Risk Increase With Symptoms From Different Origins?
Without adjustment:

```{r}
clogit(
  number_origin_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

And with adjustment

```{r}
clogit(
  number_origin_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

## By Symptom
### Bulbar Symptoms
#### Speech Problems

```{r}
clogit(
  speech_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  speech_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

#### Swallowing Problems

```{r}
clogit(
  swallowing_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  swallowing_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

### Motor Problems
#### Strength Problems
```{r}
clogit(
  strength_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  strength_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

#### Gait Problems
```{r}
clogit(
  gait_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  gait_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

#### Involuntary Movements
```{r}
clogit(
  involuntary_movement_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  involuntary_movement_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

#### Pain
```{r}
clogit(
  pain_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  pain_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

#### Falls
```{r}
clogit(
  falls_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  falls_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

#### Other
```{r}
clogit(
  other_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  other_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

### Number of Symptoms
```{r}
clogit(
  number_fml_unadj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```

```{r}
clogit(
  number_fml_fulladj,
  model_data
) |> 
  broom::tidy() |>
  mutate(
    or = exp(estimate),
    lb = exp(estimate - 1.96 * std.error),
    ub = exp(estimate + 1.96 * std.error)
  ) |>
  select(term, or, lb, ub) |>
  knitr::kable(digits = 2)
```
